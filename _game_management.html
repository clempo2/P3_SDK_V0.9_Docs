<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>P3-SDK: Game Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">P3-SDK<span id="projectnumber">&#160;0.9</span>
   </div>
   <div id="projectbrief">P3 Software Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_game_management.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Game Management </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>BaseAppMode and BaseGameMode (with help from other modes) control the flow of a game. Typically these modes are subclasses with game-specific versions.</p>
<h1 class="doxsection"><a class="anchor" id="BaseAppMode"></a>
Base Mode for all Applications</h1>
<p>BaseAppMode adds the following basic modes to the mode queue:</p><ul>
<li>GridInterfaceMode (passes the P3's playfield IR grid events to the GUI)</li>
<li>VolumeMode (handles the coin door volume buttons and notifies the GUI when volume changes are requested)</li>
<li>GUIInsertControllerMode (manages GUIInsertScripts, which are scripts that allow GUI components to be controlled similarly to physical LEDs)</li>
<li>BackboxColorsMode (has event handlers that change the colors of the P3's backbox RGB LEDs).</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="BaseGameMode"></a>
Base Mode for all Games</h1>
<p>BaseGameMode subclasses BaseAppMode and controls the basic framework of a pinball game. It does this by instantiating and adding various additional modes to the mode queue and also by implementing a set of methods that control the basic sequence of events in a game.</p>
<p>BaseGameMode adds these Modes to the mode queue:</p><ul>
<li>BallLauncherMode (controls the launching of balls from the P3's ball trough)</li>
<li>CoinDoorMode (controls the dialogs and menus when the coin door opens)</li>
<li>GameAttributeManagerMode (Manages settings, profiles, high scores and statistics)</li>
<li>GameManagerMode (handles the start button, adding players to the game, and transitioning from one ball to the next)</li>
<li>BonusMode (end of ball bonus calculations)</li>
<li>NextBallMode (decides when to transition to the next player and/or ball number)</li>
<li>BallSearchMode (searches for balls by popping coils after inactivity)</li>
<li>TiltMode (issues tilt warnings and tilt events)</li>
<li>TicketDispenseMode (controls the optional ticket dispenser)</li>
<li>SelectorManagerMode (controls dialogs and menus)</li>
<li>LogMarkerMode (adds a marker to the log when the launch button is pressed while holding a red button)</li>
<li>AttractMode (SceneMode that plays when no game is active) - typically subclassed</li>
<li>PlayfieldModuleManager (loads the playfield module driver)</li>
</ul>
<p>Most of these modes (all but BonusMode and NextBallMode) are added to the mode queue in BaseGameMode.mode_started(), which is called when BaseGameMode is added to the mode queue when the app starts running. To use a subclassed version of any of the modes, simply overwrite the associated property with the instance of the subclass.</p>
<h2 class="doxsection"><a class="anchor" id="BaseGameModeOverview"></a>
Theory of Operation of BaseGameMode</h2>
<p>When BaseGameMode starts, it adds the relevant modes to the game queue and then sits around and waits for events. When GameManagerMode sends the "Evt_AddPlayer" event, BaseGameMode starts the game by calling StartNewBall(). A game-specific subclass of BaseGameMode typically overrides StartNewBall(), first calling base.StartNewBall() so all base logic can run, and then calling p3.AddMode(homeMode), or whatever SceneMode implements the first part of the game. BaseGameMode then just waits for the "Evt_BallEnded" event, which causes it to start the bonusMode (if the bonusModeEnabled property is true), and eventually FinishEndOfBall(), which starts nextBallMode to see if the game should transition to another player or another ball. NextBallMode will respond with either "Evt_StartNextBall" or "Evt_EndGame". If it's the end of the game, BaseGameMode will optionally start the high score check process, if highScoreCheckEnabled is true, by posting "Evt_LookForHighScores", or it will call FinishEndGame. FinishEndGame starts AttractMode again.</p>
<h3 class="doxsection"><a class="anchor" id="DisablingBonusMode"></a>
Disabling Bonus Mode</h3>
<p>To keep BaseGameMode from starting the BonusMode at the end of a ball, set the <b>bonusModeEnabled</b> property to false in your BaseGameMode subclass.</p>
<h3 class="doxsection"><a class="anchor" id="DisablingHighScoresMode"></a>
Disabling High Scores Mode</h3>
<p>To keep BaseGameMode from initiating the high score check process, set the <b>highScoreCheckEnabled</b> property to false in your BaseGameMode subclass.</p>
<h3 class="doxsection"><a class="anchor" id="DisablingTiltHandling"></a>
Disabling Tilt Handling</h3>
<p>To keep BaseGameMode from starting the tilt handling mode, set the <b>tiltModeEnabled</b> property to false in your BaseGameMode subclass.</p>
<h3 class="doxsection"><a class="anchor" id="ShowBonusEventIfTiltActive"></a>
Show End-of-Ball Bonus If Tilt Active</h3>
<p>Normally the end-of-ball bonus won't be shown if the player tilted to end the ball. However, you can set the <b>showBonusIfTiltActive</b> property to true in your BaseGameMode subclass to override that logic and activate the BonusMode at end-of-ball regardless of tilt.</p>
<h3 class="doxsection"><a class="anchor" id="DisablingBackboxColorsMode"></a>
Disabling Backbox Colors Mode</h3>
<p>By default, games instantiate a class called BackboxColorsMode, which uses operator settings to set the initial color of the 3 LEDs defined for the backbox ("backbox", "backboxP3", "playfield"). "playfield" is for the lighting that shines down above the playfield. To disable backboxColorsMode so that you can have full control over those LEDs, set useBackboxColorsMode to false in your BaseGameMode constructor. <br  />
</p>
<h3 class="doxsection"><a class="anchor" id="KeepingPowerRelayOffAtStartup"></a>
Keeping Power Relay Off At Startup</h3>
<p>By default, all apps will turn on the power relay at startup. This relay enables the P3's 48V. If your app doesn't need high voltage, you might want to leave high voltage off. You can do this by setting enablePowerRelayAtStartup to false in your BaseGameMode constructor. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="_mode_layer.html">The Mode Layer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
